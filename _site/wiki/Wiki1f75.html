











<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html id="top" xmlns="http://www.w3.org/1999/xhtml">


<!-- Mirrored from rsf.fluidproject.org/wiki/Wiki.jsp?page=RSFHibernate by HTTrack Website Copier/3.x [XR&CO'2013], Fri, 07 Jun 2013 15:00:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <title>
    RSF Wiki: RSFHibernate
  </title>
  











<link rel="stylesheet" media="screen, projection, print" type="text/css"
     href="templates/default/jspwiki.css"/>

<link rel="stylesheet" type="text/css" media="print" 
     href="templates/default/jspwiki_print.css" />
<!-- INCLUDERESOURCES (stylesheet) -->

<!-- INCLUDERESOURCES (inlinecss) -->



<noscript>
<style type="text/css">
#hiddenmorepopup { display:block; }
</style>
</noscript>


<script type="text/javascript" src="scripts/mootools.js"></script>
<script type="text/javascript" src="scripts/prettify.js"></script>
<script type="text/javascript" src="scripts/jspwiki-common.js"></script>
<script type="text/javascript" src="scripts/jspwiki-commonstyles.js"></script>
<!-- INCLUDERESOURCES (script) -->





<meta name="wikiContext" content='view' />
<meta name="wikiBaseUrl" content='http://rsf.fluidproject.org/wiki/' />
<meta name="wikiPageUrl" content='/wiki/Wiki.jsp?page=%23%24%25' />
<meta name="wikiEditUrl" content='/wiki/Edit.jsp?page=RSFHibernate' />
<meta name="wikiJsonUrl" content='/wiki/JSON-RPC' />
<meta name="wikiPageName" content='RSFHibernate' />
<meta name="wikiUserName" content='207.119.0.6' />
<meta name="wikiTemplateUrl" content='/wiki/templates/default/' />
<meta name="wikiApplicationName" content='RSF Wiki' />

<script type="text/javascript">//<![CDATA[
/* Localized javascript strings: LocalizedStrings[] */
var LocalizedStrings = {
"javascript.edit.allsections":"( All )",
"javascript.slimbox.error":"<h2>Error</h2>There was a problem with your request.<br />Please try again",
"javascript.slimbox.remoteRequest":"Remote Request {0} of {1}",
"javascript.slimbox.close":"Close &#215;",
"javascript.quick.edit":"[Edit]",
"javascript.sort.descending":"Descending order. Click to reverse sort order",
"javascript.expand":"Click to expand",
"javascript.group.validName":"Please provide a valid name for the new Group",
"javascript.slimbox.next":"Next&raquo;",
"javascript.filter.all":"( All )",
"javascript.edit.areyousure":"Without clicking the Save button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.quick.edit.title":"Edit section {0}...",
"javascript.slimbox.directLink":"Direct Link to the target",
"javascript.prefs.areyousure":"Without clicking the Save User Preferences button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.sbox.clone.suffix":"-New",
"javascript.slimbox.info":"Image {0} of {1}",
"javascript.tip.default.title":"More...",
"javascript.edit.resize":"Drag to resize the text area",
"javascript.edit.findandreplace.nomatch":"No match found!",
"javascript.sort.ascending":"Ascending order. Click to reverse sort order",
"javascript.slimbox.close.title":"Close [Esc]",
"javascript.edit.toolbar.makeSelection":"Please make first a selection.",
"javascript.favs.hide":"Click to hide Favorites",
"javascript.sectionediting.label":"Section Overview",
"javascript.slimbox.previous":"&laquo;Previous",
"javascript.favs.show":"Click to show Favorites",
"javascript.collapse":"Click to collapse",
"javascript.category.title":"Click to show category [{0}] ...",
"javascript.sort.click":"Click to sort",
"javascript.edit.startOfPage":"( Start of page )"
};


/* INCLUDERESOURCES (jsfunction) */

//]]></script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="search" href="Wiki702d.html?page=FindPage"
    title='Search RSF Wiki' />
<link rel="help"   href="Wikia3b7.html?page=TextFormattingRules"
    title="Help" />

 <link rel="start"  href="Wikib2ab.html?page=Main"
    title="Front page" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki_print.css"
    title="Print friendly" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki.css"
    title="Standard" />
<link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico" />

<link rel="icon" type="image/x-icon" href="images/favicon.ico" />



  









  
  
  
</head>

<body class="view">

<div id="wikibody" class="fav-left">
 
  






<div id="header">

  <div class="titlebox"></div>

  <div class="applicationlogo" > 
    <a href="Wikib2ab.html?page=Main"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login001b.html?redirect=RSFHibernate" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences001b.html?redirect=RSFHibernate"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>

  <div class="pagename">RSFHibernate</div>

  <div class="searchbox">






<form action="http://rsf.fluidproject.org/wiki/Search.jsp"
        class="wikiform"
           id="searchForm" accept-charset="UTF-8">

  <div style="position:relative">
  <input onblur="if( this.value == '' ) { this.value = this.defaultValue }; return true; "
        onfocus="if( this.value == this.defaultValue ) { this.value = ''}; return true; "
           type="text" value="Quick Navigation"
           name="query" id="query"
           size="20" 
      accesskey="f" />
  <button type="submit"
  		 name="searchSubmit" id="searchSubmit"
  		value="Go!"
  		title="Go!"></button>
  </div>
  <div id="searchboxMenu" style='visibility:hidden;'>
    <div id="searchTools">
      <a href="#" id='quickView' class='action'
      onclick="SearchBox.navigate( 'Wiki195c.html?page=__PAGEHERE__','View the selected page' );"
        title="View the selected page">view</a>
      <a href="#" id='quickEdit' class='action'
      onclick="SearchBox.navigate( 'Logine830.html?page=__PAGEHERE__','Edit the selected page' );"
        title="Edit the selected page">edit</a>
      <a href="#" id='quickClone' class='action'	
      onclick="return SearchBox.navigate( 'Logine830.html?page=__PAGEHERE__', 'Clone the selected page', true );"
        title="Clone the selected page">clone</a>
      <a href="#" id="advancedSearch" class='action'
      onclick="SearchBox.navigate( 'Search136d.html?query=__PAGEHERE__','RSFHibernate' )"
        title="Advanced Search [ f ]">find</a>
    </div>
    <div id="searchResult" >
	  Quick search
      <span id="searchTarget" >(type ahead)</span>
      <span id="searchSpin" class="spin" style="position:absolute;display:none;"></span>
	  <div id="searchOutput" ></div>
    </div>
    <div id="recentSearches" style="display:none;">
      Recent Searches
      <span><a href="#" id="recentClear">(Clear)</a></span>
    </div>
  </div>

</form></div>

  <div class="breadcrumbs">Your trail:&nbsp;<a class="wikipage" href="Wiki7958.html?page=NamedHeadings">NamedHeadings</a>, <a class="wikipage" href="Wiki7f5c.html?page=WikiName">WikiName</a>, <a class="wikipage" href="Wiki8c3c.html?page=WikiVariables">WikiVariables</a>, <a class="wikipage" href="Wiki8e8b.html?page=WikiForms">WikiForms</a>, <a class="wikipage" href="Wikiabdd.html?page=JSF">JSF</a>, <a class="wikipage" href="Wiki0665.html?page=TemplateValidity">TemplateValidity</a>, <a class="wikipage" href="Wiki5ced.html?page=RightFirstTime">RightFirstTime</a>, <a class="wikipage" href="Wikid989.html?page=Javascript">Javascript</a>, <a class="wikipage" href="Wikia36a.html?page=RSAC">RSAC</a>, <a class="wikipage" href="Wikib036.html?page=SpringAPI">SpringAPI</a></div>

</div>

  <div id="content">

    <div id="page">
      





<div id="actionsTop" class="pageactions"> 
  <ul>

    
    
    

    
    <li id="morebutton">
      <a href="Wiki81b4.html?page=MoreMenu" class="action more">More...</a>
    </li>

  </ul>
</div>

      








<div class="tabmenu">

  

  

  
  
  
    
  
    
  



  <a class="activetab" id="menu-pagecontent" accesskey="v" ><span class='accesskey'>V</span>iew</a>

  

  
  <a id="menu-attach" accesskey="a" ><span class='accesskey'>A</span>ttach</a>
  
    
  <a id="menu-info" href='PageInfo1f75.html?page=RSFHibernate' accesskey="i" ><span class='accesskey'>I</span>nfo</a>
    
  

</div>
<div class="tabs">

  <div id="pagecontent" >

    











<p>Like Spring-Hibernate, <a class="external" href="https://saffron.caret.cam.ac.uk/svn/projects/RSFHibernate/">RSFHibernate</a><img class="outlink" src="images/out.png" alt="" /> tries to remove the dependence on Hibernate in user code, but can go a little further in removing coupled code as a result of having RSAC. The key points of RSF ORM are 
</p><h4 id="section-RSFHibernate-TheUseOfRSACToInjectQueryResultsIntoRequestBeans."> The use of <a class="wikipage" href="Wikia36a.html?page=RSAC">RSAC</a> to inject query results into request beans.<a class="hashlink" href="#section-RSFHibernate-TheUseOfRSACToInjectQueryResultsIntoRequestBeans.">#</a></h4>
<p>You can see this at work in the <a class="external" href="http://www2.caret.cam.ac.uk/rsfwiki/Wiki.jsp?page=HibernateCookBook_4">Java version</a><img class="outlink" src="images/out.png" alt="" /> of the Hibernate cookbook - the view producer (a request-scope bean) has the results of an HQL query injected into it via this setter:
</p>
<pre>
  public void setRecipeList(List recipelist) {
    this.recipelist = recipelist;
  }
</pre>
where the corresponding query is defined in <tt>requestContext.xml</tt> as the following bean:
<pre>
  &lt;bean id=&quot;recipes-all&quot; parent=&quot;HQLQuery&quot;&gt;
    &lt;property name=&quot;HQLString&quot; value=&quot;from Recipe&quot; /&gt;
  &lt;/bean&gt;
</pre>
This works very well - the target bean is unaware of the kind of ORM solution it is using, or even that it is using any ORM at all, and we are saved from having to write any tedious DAO interfaces or implementations.
<p />
<h4 id="section-RSFHibernate-TheOTPOneTruePathSystem."> The <a class="wikipage" href="Wikif73b.html?page=OTP">OTP</a> (One True Path) system.<a class="hashlink" href="#section-RSFHibernate-TheOTPOneTruePathSystem.">#</a></h4>
<p>This is explained in more detail on its own page. If you are not writing a webapp, the representation of this via <a class="wikipage" href="Wiki2b2a.html?page=EL">EL</a> will be less useful, but you may wish to use some of the underlying infrastructure directly. The key implementation is <a class="external" href="https://saffron.caret.cam.ac.uk/svn/projects/RSFHibernate/trunk/src/java/uk/org/ponder/rsf/hibernate/HibernateEntityBeanLocator.java">HibernateEntityBeanLocator</a><img class="outlink" src="images/out.png" alt="" /> or HEBL, which to most clients can be treated as a <a class="external" href="https://saffron.caret.cam.ac.uk/svn/projects/PonderUtilCore/trunk/src/uk/org/ponder/beanutil/WriteableBeanLocator.java">WriteableBeanLocator</a><img class="outlink" src="images/out.png" alt="" /> with 3 methods, <tt>set</tt>, <tt>remove</tt> and <tt>locateBean</tt>. This manages all beans of a particular class, and takes note of any entities which have passed through its hands, for later use of the AlterationWrapper.
<h4 id="section-RSFHibernate-TheAlterationWrapper"> The <a class="external" href="https://saffron.caret.cam.ac.uk/svn/projects/RSFHibernate/trunk/src/java/uk/org/ponder/rsf/hibernate/HibernateAlterationWrapper.java">AlterationWrapper</a><img class="outlink" src="images/out.png" alt="" /><a class="hashlink" href="#section-RSFHibernate-TheAlterationWrapper">#</a></h4>
A request-scope bean which centralises commit/rollback logic in one bean. Its basic function is to accept one <tt>Runnable</tt> object (in which is presumably enclosed all of your persistent request logic) and to return another, where the supplied Runnable has been bracketed by the (request-aware) logic contained in the Wrapper. It is a neat solution to the potential dependency bind caused by having MORE dependencies inside code which needs to execute AROUND a target set - it could be made yet more minimal by the use of Spring AOP, but does not require it.
</p>
<p>Here is the bean definition of HAW from <tt>hibernate-requestContext.xml</tt>:
</p>
<pre>
  &lt;bean id=&quot;alterationWrapper&quot; class=&quot;uk.org.ponder.rsf.hibernate.HibernateAlterationWrapper&quot;
  lazy-init=&quot;true&quot;&gt;
    &lt;property name=&quot;sessionFactory&quot;&gt;
      &lt;!-- EXTERNAL DEPENDENCY!!! A Hibernate-enabled RSF app must define a bean with this
        name that dispenses a SessionFactory. --&gt;
      &lt;ref bean=&quot;sessionFactory&quot;/&gt;
    &lt;/property&gt;
    &lt;property name=&quot;mappingContext&quot; ref=&quot;ELMappingContext&quot;/&gt;
    &lt;property name=&quot;requestType&quot; ref=&quot;requestType&quot;/&gt;
    &lt;property name=&quot;entityIDRewriter&quot; ref=&quot;hibernate-entityBeanManager&quot;/&gt;
    &lt;property name=&quot;ARIResult&quot; ref=&quot;ARIResult&quot;/&gt;
  &lt;/bean&gt;
</pre>
Note that this is marked as a <a class="wikipage" href="Wiki9b45.html?page=VeryLazyBeans">very lazy bean</a> to avoid a dependence-construction cycle. It overrides the &quot;blank&quot; alteration wrapper defined in the blank context, and will most likely be overridden in turn by a more specific user definition.
<p>Based on information from the request context, the wrapper decides whether this cycle will cause a commit, or if it has caused an exception will cause a rollback. The wrapper also does the work of taking account of any <i>new</i> entities, which were signalled by being stored via a special EL path (currently configured to be those starting with <tt>new</tt> followed by a space, and then arbitrary text). These will not have their persistent IDs assigned until the transaction ends, and so in the case the request action depends on knowing these IDs, it can register a listener to be informed of the rewrite. However, since until the entire request context is cleaned up, these <i>new entities</i> are still visible inside the HEBL at the old path IDs, it may well be simpler to just inspect them from there after transaction commit, but before the request ends, to find out what their IDs are. In general this is another symptom of the benefits you typically get from RSF/RSAC's avoidance of the &quot;fire and forget&quot; style of Spring non-singletons, or in general other non-managed beans - even in request scope, every bean created is permanently attached to a particular path where it can be located later by interested code.
</p>
<p />
<p>For those familiar with Spring, you might like to think of this class as somewhat similar to <tt>HibernateTemplate.execute</tt>, with the supplied <tt>Runnable</tt> object taking the role of the <tt>HibernateCallback</tt>. The interfaces in RSF-ORM can in general be enormously less fat than <tt>HibernateTemplate</tt> since we have the capability of <a class="wikipage" href="Wikia650.html?page=RequestScopeBeans">request-scope beans</a> - without this, a Spring application-time interface needs to anticipate <i>every possible</i> runtime operation and dependency. With <a class="wikipage" href="Wikia36a.html?page=RSAC">RSAC</a>, each bean can be defined to acquire only the request-time dependencies it needs. 
</p>
<p>In general you might well want a different implementation of AlterationWrapper for your particular transactional and request semantics - with RSAC, this is just a matter of overriding this bean definition.
</p>






        
  </div>


  

  
  <div id="attach" class="hidetab" >

    










<div id="addattachment">
<h3>Add new attachment</h3>


<div class="formhelp">Only authorized users are allowed to upload new attachments.</div>

</div>



  </div>

  
    
  <div id="info" class="hidetab" >

  </div>

    
  

<div style="clear:both;" ></div>
</div>

      







<div id='actionsBottom' class="pageactions"> 
    

    <a href="#top" 
      class="action quick2top" 
      title="Go to top" >&laquo;</a>

    
       This page (revision-) was last changed on <a href="Diff3a3d.html?page=RSFHibernate&amp;r1=-1&amp;r2=1">19-Jul-2006 09:36</a> by UnknownAuthor
    

    

   

  

   
</div>

    </div>

    






<div id="favorites">

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login001b.html?redirect=RSFHibernate" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences001b.html?redirect=RSFHibernate"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>
  
  <div id="hiddenmorepopup">
  <ul id="morepopup">
     
       	
     
       
     
    
       
     
       <li>
       
       <a class="action rawpage wikipage" 
               href="Wiki1359.html?page=RSFHibernate&amp;skin=raw"
              title="View Page Source">View Page Source
       </a>
       
       
       </li>
      
        
  
      
      
      

      
	  <li class='separator'>
        <div id="moremenu" ></div>
      </li>
  </ul>
  </div>
  
  

  

  

  
  <div class="leftmenu">
    <p><a class="wikipage" href="Wikib2ab.html?page=Main">Main page</a><br />
<tt> </tt><i><a class="wikipage" href="Wiki4d3f.html?page=ThisWiki">About</a></i><br />
</p><p><a class="wikipage" href="Wikid6f0.html?page=GettingStarted">Getting Started</a><br />
</p>
<p><b>Documentation</b><br />
<tt> </tt><a class="wikipage" href="Wiki4c8c.html?page=Developers">Developers</a><br />
<tt>  </tt><a class="wikipage" href="Wikib1ce.html?page=Javadocs">Javadocs</a><br />
<tt> </tt><a class="wikipage" href="Wikia56b.html?page=Designers">Designers</a><br />
<tt> </tt><a class="wikipage" href="Wiki4509.html?page=SampleRSFApps">Sample RSF Apps</a><br />
<tt> </tt><a class="wikipage" href="Wikif010.html?page=Presentations">Presentations</a><br />
<tt> </tt><a class="wikipage" href="Wiki45f9.html?page=Acronyms">Acronyms</a><br />
</p>
<p><b>Downloads</b><br />
<tt> </tt><a class="wikipage" href="Wiki30c9.html?page=CurrentCode">Current Release</a><br />
<tt> </tt><a class="wikipage" href="Wiki0e27.html?page=TrunkCode">Trunk</a><br />
<tt> </tt><a class="wikipage" href="Wiki1a8d.html?page=CodeDistributions">Distributions</a><br />
<tt> </tt><a class="wikipage" href="Wikiadaf.html?page=OldCode">Old Versions</a><br />
</p>
<p><b>Community</b><br />
<tt> </tt><a class="wikipage" href="Wiki84f4.html?page=QampA">Q&amp;A</a><br />
<tt> </tt><a class="external" href="http://ponder.org.uk/rsf/">Forums</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wikif345.html?page=EmailLists">Mailing Lists</a><br />
<tt> </tt><a class="external" href="http://www.caret.cam.ac.uk/jira/browse/RSF">Issue Tracker</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wiki1535.html?page=People">People</a><br />
</p>
<p><b>Design</b><br />
<tt> </tt><a class="wikipage" href="Wiki580c.html?page=Roadmap">Roadmap</a><br />
<tt> </tt><a class="wikipage" href="Wiki654d.html?page=Integrations">Integrations</a><br />
<tt> </tt><a class="wikipage" href="Wikia360.html?page=Concepts">Concepts</a><br />
<tt> </tt><a class="wikipage" href="Wiki151d.html?page=Philosophy">Philosophy</a><br />
</p>
<div style="font-style:italic;font-size:0.8em;">
<b>Pages</b><br />
<tt> </tt><a class="wikipage" href="Wiki702d.html?page=FindPage">Find</a><br />
<tt> </tt><a class="wikipage" href="Wiki5fc7.html?page=RecentChanges">Recent Changes</a><br />
<tt> </tt><a class="wikipage" href="Wikife97.html?page=UnusedPages">Unused</a><br />
<tt> </tt><a class="wikipage" href="Wiki5130.html?page=UndefinedPages">Undefined</a><br />
<tt> </tt><a class="wikipage" href="Wiki5f9e.html?page=PageIndex">Index</a>
</div>
<p />
    
  </div>
  
  <div class="leftmenufooter">
    <hr />
<p><b>Referenced by</b><br />
<a class="wikipage" href="Wiki1a8d.html?page=CodeDistributions">CodeDistributions</a><br /><a class="wikipage" href="Wiki2b2a.html?page=EL">EL</a><br /><a class="wikipage" href="Wikia36a.html?page=RSAC">RSAC</a><br /><a class="wikipage" href="Wikib91f.html?page=RSF">RSF</a><br /><a class="wikipage" href="Wiki1025.html?page=RSFORMByItself">RSFORMByItself</a><br /><a class="wikipage" href="Wikib036.html?page=SpringAPI">SpringAPI</a><br /><a class="wikipage" href="Wiki13ad.html?page=ZigguratOfIntegration">ZigguratOfIntegratio...</a><br />
</p>
    
  </div>

  

  
  
  <div class="wikiversion">JSPWiki v2.8.2
  <span class="rssfeed">
    
  </span>
  </div>  
  
</div>

	<div class="clearbox"></div>
  </div>

  





 
<div id="footer">

  <div class="applicationlogo" > 
    <a href="Wikib2ab.html?page=Main"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  <div class="copyright"></div>

  <div class="wikiversion">
    JSPWiki v2.8.2
  </div>

  <div class="rssfeed">
    
  </div>

</div>

</div>

</body>

<!-- Mirrored from rsf.fluidproject.org/wiki/Wiki.jsp?page=RSFHibernate by HTTrack Website Copier/3.x [XR&CO'2013], Fri, 07 Jun 2013 15:00:30 GMT -->
</html>

