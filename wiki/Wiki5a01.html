











<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html id="top" xmlns="http://www.w3.org/1999/xhtml">


<!-- Mirrored from rsf.fluidproject.org/wiki/Wiki.jsp?page=ScopedBeans by HTTrack Website Copier/3.x [XR&CO'2013], Fri, 07 Jun 2013 15:15:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <title>
    RSF Wiki: ScopedBeans
  </title>
  











<link rel="stylesheet" media="screen, projection, print" type="text/css"
     href="templates/default/jspwiki.css"/>

<link rel="stylesheet" type="text/css" media="print" 
     href="templates/default/jspwiki_print.css" />
<!-- INCLUDERESOURCES (stylesheet) -->

<!-- INCLUDERESOURCES (inlinecss) -->



<noscript>
<style type="text/css">
#hiddenmorepopup { display:block; }
</style>
</noscript>


<script type="text/javascript" src="scripts/mootools.js"></script>
<script type="text/javascript" src="scripts/prettify.js"></script>
<script type="text/javascript" src="scripts/jspwiki-common.js"></script>
<script type="text/javascript" src="scripts/jspwiki-commonstyles.js"></script>
<!-- INCLUDERESOURCES (script) -->





<meta name="wikiContext" content='view' />
<meta name="wikiBaseUrl" content='http://rsf.fluidproject.org/wiki/' />
<meta name="wikiPageUrl" content='/wiki/Wiki.jsp?page=%23%24%25' />
<meta name="wikiEditUrl" content='/wiki/Edit.jsp?page=ScopedBeans' />
<meta name="wikiJsonUrl" content='/wiki/JSON-RPC' />
<meta name="wikiPageName" content='ScopedBeans' />
<meta name="wikiUserName" content='207.119.0.6' />
<meta name="wikiTemplateUrl" content='/wiki/templates/default/' />
<meta name="wikiApplicationName" content='RSF Wiki' />

<script type="text/javascript">//<![CDATA[
/* Localized javascript strings: LocalizedStrings[] */
var LocalizedStrings = {
"javascript.edit.allsections":"( All )",
"javascript.slimbox.error":"<h2>Error</h2>There was a problem with your request.<br />Please try again",
"javascript.slimbox.remoteRequest":"Remote Request {0} of {1}",
"javascript.slimbox.close":"Close &#215;",
"javascript.quick.edit":"[Edit]",
"javascript.sort.descending":"Descending order. Click to reverse sort order",
"javascript.expand":"Click to expand",
"javascript.group.validName":"Please provide a valid name for the new Group",
"javascript.slimbox.next":"Next&raquo;",
"javascript.filter.all":"( All )",
"javascript.edit.areyousure":"Without clicking the Save button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.quick.edit.title":"Edit section {0}...",
"javascript.slimbox.directLink":"Direct Link to the target",
"javascript.prefs.areyousure":"Without clicking the Save User Preferences button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.sbox.clone.suffix":"-New",
"javascript.slimbox.info":"Image {0} of {1}",
"javascript.tip.default.title":"More...",
"javascript.edit.resize":"Drag to resize the text area",
"javascript.edit.findandreplace.nomatch":"No match found!",
"javascript.sort.ascending":"Ascending order. Click to reverse sort order",
"javascript.slimbox.close.title":"Close [Esc]",
"javascript.edit.toolbar.makeSelection":"Please make first a selection.",
"javascript.favs.hide":"Click to hide Favorites",
"javascript.sectionediting.label":"Section Overview",
"javascript.slimbox.previous":"&laquo;Previous",
"javascript.favs.show":"Click to show Favorites",
"javascript.collapse":"Click to collapse",
"javascript.category.title":"Click to show category [{0}] ...",
"javascript.sort.click":"Click to sort",
"javascript.edit.startOfPage":"( Start of page )"
};


/* INCLUDERESOURCES (jsfunction) */

//]]></script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="search" href="Wiki702d.html?page=FindPage"
    title='Search RSF Wiki' />
<link rel="help"   href="Wikia3b7.html?page=TextFormattingRules"
    title="Help" />

 <link rel="start"  href="Wikib2ab.html?page=Main"
    title="Front page" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki_print.css"
    title="Print friendly" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki.css"
    title="Standard" />
<link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico" />

<link rel="icon" type="image/x-icon" href="images/favicon.ico" />



  









  
  
  
</head>

<body class="view">

<div id="wikibody" class="fav-left">
 
  






<div id="header">

  <div class="titlebox"></div>

  <div class="applicationlogo" > 
    <a href="Wikib2ab.html?page=Main"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login52e9.html?redirect=ScopedBeans" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences52e9.html?redirect=ScopedBeans"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>

  <div class="pagename">ScopedBeans</div>

  <div class="searchbox">






<form action="http://rsf.fluidproject.org/wiki/Search.jsp"
        class="wikiform"
           id="searchForm" accept-charset="UTF-8">

  <div style="position:relative">
  <input onblur="if( this.value == '' ) { this.value = this.defaultValue }; return true; "
        onfocus="if( this.value == this.defaultValue ) { this.value = ''}; return true; "
           type="text" value="Quick Navigation"
           name="query" id="query"
           size="20" 
      accesskey="f" />
  <button type="submit"
  		 name="searchSubmit" id="searchSubmit"
  		value="Go!"
  		title="Go!"></button>
  </div>
  <div id="searchboxMenu" style='visibility:hidden;'>
    <div id="searchTools">
      <a href="#" id='quickView' class='action'
      onclick="SearchBox.navigate( 'Wiki195c.html?page=__PAGEHERE__','View the selected page' );"
        title="View the selected page">view</a>
      <a href="#" id='quickEdit' class='action'
      onclick="SearchBox.navigate( 'Logine830.html?page=__PAGEHERE__','Edit the selected page' );"
        title="Edit the selected page">edit</a>
      <a href="#" id='quickClone' class='action'	
      onclick="return SearchBox.navigate( 'Logine830.html?page=__PAGEHERE__', 'Clone the selected page', true );"
        title="Clone the selected page">clone</a>
      <a href="#" id="advancedSearch" class='action'
      onclick="SearchBox.navigate( 'Search136d.html?query=__PAGEHERE__','ScopedBeans' )"
        title="Advanced Search [ f ]">find</a>
    </div>
    <div id="searchResult" >
	  Quick search
      <span id="searchTarget" >(type ahead)</span>
      <span id="searchSpin" class="spin" style="position:absolute;display:none;"></span>
	  <div id="searchOutput" ></div>
    </div>
    <div id="recentSearches" style="display:none;">
      Recent Searches
      <span><a href="#" id="recentClear">(Clear)</a></span>
    </div>
  </div>

</form></div>

  <div class="breadcrumbs">Your trail:&nbsp;<a class="wikipage" href="Wiki1a86.html?page=LogonTest_1">LogonTest_1</a>, <a class="wikipage" href="Wiki022d.html?page=BeanExploder">BeanExploder</a>, <a class="wikipage" href="Wiki6979.html?page=BeanLocator">BeanLocator</a>, <a class="wikipage" href="Wiki341c.html?page=BeanReasonableness">BeanReasonableness</a>, <a class="wikipage" href="Wiki7132.html?page=Levelization">Levelization</a>, <a class="wikipage" href="Wikibcf8.html?page=ObstinateMap">ObstinateMap</a>, <a class="wikipage" href="Wikie9e9.html?page=ParachuteRendering">ParachuteRendering</a>, <a class="wikipage" href="Wiki5ad5.html?page=Peas">Peas</a>, <a class="wikipage" href="Wiki57fb.html?page=RSVCReplay">RSVCReplay</a>, <a class="wikipage" href="Wiki5086.html?page=LongTransaction">LongTransaction</a></div>

</div>

  <div id="content">

    <div id="page">
      





<div id="actionsTop" class="pageactions"> 
  <ul>

    
    
    

    
    <li id="morebutton">
      <a href="Wiki81b4.html?page=MoreMenu" class="action more">More...</a>
    </li>

  </ul>
</div>

      








<div class="tabmenu">

  

  

  
  
  
    
  
    
  



  <a class="activetab" id="menu-pagecontent" accesskey="v" ><span class='accesskey'>V</span>iew</a>

  

  
  <a id="menu-attach" accesskey="a" ><span class='accesskey'>A</span>ttach</a>
  
    
  <a id="menu-info" href='PageInfo5a01.html?page=ScopedBeans' accesskey="i" ><span class='accesskey'>I</span>nfo</a>
    
  

</div>
<div class="tabs">

  <div id="pagecontent" >

    











<p>RSF's scoped beans are actually perfectly normal <a class="wikipage" href="Wikia650.html?page=RequestScopeBeans">request-scoped beans</a>, but who are copied into some longer term storage (such as the HTTP session) at the end of a request. These beans are automatically restored at the beginning of each RSF request cycle if they are present. If they are not present in the storage, the corresponding request-scope bean is initialised with the normal Spring semantics - i.e. its <tt>init-method</tt> will be called, if any, &amp;c. For a scoped bean restored from storage, the only framework action for this cycle will be to deliver into it any request-scope dependencies declared for it in the <tt>requestContext.xml</tt> file. 
</p><p>In the default HTTP/Servlet configuration, these beans are stored in the HTTP Session, although in other RSF environments this will transparently adjust to using whatever kind of Session is appropriate (PortletSession for the JSR-168 environment, SakaiSession for Sakai, etc.).
</p>
<p>If you want more control over where your scoped beans are stored, you may implement your own <a class="wikipage" href="Wiki2664.html?page=TokenStateHolder">TokenStateHolder</a> which will place them elsewhere (in a database table, for example). This is why these beans have been called simply, &quot;scoped beans&quot;, rather than &quot;session scoped beans&quot; as they might have, in other, less abstracted frameworks.
</p>
<h4 id="section-ScopedBeans-DifferenceToFlowBeans"> Difference to Flow Beans <a class="hashlink" href="#section-ScopedBeans-DifferenceToFlowBeans">#</a></h4>
<p>RSF's scoped beans are complementary to its <a class="wikipage" href="Wiki8680.html?page=Flows">flow</a>-scoped beans. Whilst these are actually stored in the same <a class="wikipage" href="Wiki2664.html?page=TokenStateHolder">TokenStateHolder</a> (<tt>flowTokenStateHolder</tt>), their lifetimes behave quite differently. Whilst a flow-scoped bean has its lifetime (in the session) tied to a linked set of requests forming a flow, a scoped bean simply hangs around in its storage until it is explicitly destroyed by a call to the <tt>ScopedBeanManager</tt> for its scope. This makes them more suitable for non-request-related storage uses such as logon information, shopping carts and the like, rather than flow-scoped beans which are more useful for the intermediate storage of multi-page wizards, or games/tests.
</p>
<p>Note that you may not declare the same bean to be a flow bean and a scoped bean at the same time!
</p>
<h4 id="section-ScopedBeans-Example">Example<a class="hashlink" href="#section-ScopedBeans-Example">#</a></h4>
<p>To declare a new bean scope, simply make a definition like the following at application scope, deriving from the standard framework parent bean <tt>beanScopeParent</tt>
</p>
<pre>
  &lt;bean id=&quot;myBeanScope&quot; parent=&quot;beanScopeParent&quot;&gt;
    &lt;property name=&quot;copyPreservingBeans&quot; value=&quot;mybean1, mybean2&quot;/&gt;
  &lt;/bean&gt;
</pre>
<p>This example declares a new bean scope named <tt>myBeanScope</tt> that manages the scope of two request-scope beans named <tt>mybean1</tt> and <tt>mybean2</tt>. You will need to have given <tt>mybean1</tt> and <tt>mybean2</tt> separate definitions in request scope, together with any dependencies they may require to contextualise them for the current request (probably none, since scoped beans usually have the purpose of storing state, not logic - however, you may be an O-O purist :P)
</p>
<p>Note that since all <a class="wikipage" href="Wikia36a.html?page=RSAC">RSAC</a> beans are by default <a class="wikipage" href="Wiki9b45.html?page=VeryLazyBeans">lazy</a>, these beans will not be initialised (nor stored in the session) until their first use in a request. Once they are initialised for any request, they will hang around indefinitely, with the lifetime given by the <a class="wikipage" href="Wiki2664.html?page=TokenStateHolder">TokenStateHolder</a> (as standard, the HTTP session), or until they are deallocated by you, whichever happens first.
</p>
<h4 id="section-ScopedBeans-DestroyingBeansInAScope">Destroying beans in a scope<a class="hashlink" href="#section-ScopedBeans-DestroyingBeansInAScope">#</a></h4>
<p>When you want to deallocate your scoped beans (from their backing storage), you have two main choices. Firstly, you may directly inject the <tt>ScopedBeanManager</tt> bean you defined above into your <tt>ViewProducer</tt>, under the interface <tt>BeanDestroyer</tt>, and call its <tt>destroy()</tt> method. This is not really recommended since it mixes application logic with view logic.
</p>
<p>A more sound method is to issue a <a class="wikipage" href="Wiki53e2.html?page=Bindings">deletion binding</a> targetted at the scope manager via <a class="wikipage" href="Wiki2b2a.html?page=EL">EL</a>. In general you will want this binding to be attached to a particular <a class="wikipage" href="Wikid72f.html?page=UICommand">UICommand</a> control which performs an action associated with clearing the state (such as logging off, or emptying a shopping cart, etc.). 
</p>
<p>For example,
</p>
<pre>
  UICommand logoff = UICommand.make(form, &quot;login-logoff&quot;);
  logoff.parameters.add(new UIDeletionBinding(&quot;#{destroyScope.myBeanScope}&quot;));
</pre>
<p><tt>destroyScope</tt> is a standard RSF &quot;EL machine&quot; that does the work of invoking the destroy method on the appropriate scope manager. In this case, it destroys beans in the scope &quot;myBeanScope&quot; that we declared earlier. Note however that though we say it &quot;destroys the beans&quot;, this action will <i>not affect your application logic in any way</i>. All that &quot;destruction&quot; means in this case is that the relevant beans be removed from the backing storage (e.g. Session), and not persisted at the end of the current request. Therefore, any effects from the destruction will not be seen until subsequent requests.
</p>
<p />






        
  </div>


  

  
  <div id="attach" class="hidetab" >

    










<div id="addattachment">
<h3>Add new attachment</h3>


<div class="formhelp">Only authorized users are allowed to upload new attachments.</div>

</div>



  </div>

  
    
  <div id="info" class="hidetab" >

  </div>

    
  

<div style="clear:both;" ></div>
</div>

      







<div id='actionsBottom' class="pageactions"> 
    

    <a href="#top" 
      class="action quick2top" 
      title="Go to top" >&laquo;</a>

    
       This page (revision-) was last changed on <a href="Diff9f7b.html?page=ScopedBeans&amp;r1=-1&amp;r2=1">03-Aug-2007 16:09</a> by UnknownAuthor
    

    

   

  

   
</div>

    </div>

    






<div id="favorites">

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login52e9.html?redirect=ScopedBeans" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences52e9.html?redirect=ScopedBeans"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>
  
  <div id="hiddenmorepopup">
  <ul id="morepopup">
     
       	
     
       
     
    
       
     
       <li>
       
       <a class="action rawpage wikipage" 
               href="Wikie85f.html?page=ScopedBeans&amp;skin=raw"
              title="View Page Source">View Page Source
       </a>
       
       
       </li>
      
        
  
      
      
      

      
	  <li class='separator'>
        <div id="moremenu" ></div>
      </li>
  </ul>
  </div>
  
  

  

  

  
  <div class="leftmenu">
    <p><a class="wikipage" href="Wikib2ab.html?page=Main">Main page</a><br />
<tt> </tt><i><a class="wikipage" href="Wiki4d3f.html?page=ThisWiki">About</a></i><br />
</p><p><a class="wikipage" href="Wikid6f0.html?page=GettingStarted">Getting Started</a><br />
</p>
<p><b>Documentation</b><br />
<tt> </tt><a class="wikipage" href="Wiki4c8c.html?page=Developers">Developers</a><br />
<tt>  </tt><a class="wikipage" href="Wikib1ce.html?page=Javadocs">Javadocs</a><br />
<tt> </tt><a class="wikipage" href="Wikia56b.html?page=Designers">Designers</a><br />
<tt> </tt><a class="wikipage" href="Wiki4509.html?page=SampleRSFApps">Sample RSF Apps</a><br />
<tt> </tt><a class="wikipage" href="Wikif010.html?page=Presentations">Presentations</a><br />
<tt> </tt><a class="wikipage" href="Wiki45f9.html?page=Acronyms">Acronyms</a><br />
</p>
<p><b>Downloads</b><br />
<tt> </tt><a class="wikipage" href="Wiki30c9.html?page=CurrentCode">Current Release</a><br />
<tt> </tt><a class="wikipage" href="Wiki0e27.html?page=TrunkCode">Trunk</a><br />
<tt> </tt><a class="wikipage" href="Wiki1a8d.html?page=CodeDistributions">Distributions</a><br />
<tt> </tt><a class="wikipage" href="Wikiadaf.html?page=OldCode">Old Versions</a><br />
</p>
<p><b>Community</b><br />
<tt> </tt><a class="wikipage" href="Wiki84f4.html?page=QampA">Q&amp;A</a><br />
<tt> </tt><a class="external" href="http://ponder.org.uk/rsf/">Forums</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wikif345.html?page=EmailLists">Mailing Lists</a><br />
<tt> </tt><a class="external" href="http://www.caret.cam.ac.uk/jira/browse/RSF">Issue Tracker</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wiki1535.html?page=People">People</a><br />
</p>
<p><b>Design</b><br />
<tt> </tt><a class="wikipage" href="Wiki580c.html?page=Roadmap">Roadmap</a><br />
<tt> </tt><a class="wikipage" href="Wiki654d.html?page=Integrations">Integrations</a><br />
<tt> </tt><a class="wikipage" href="Wikia360.html?page=Concepts">Concepts</a><br />
<tt> </tt><a class="wikipage" href="Wiki151d.html?page=Philosophy">Philosophy</a><br />
</p>
<div style="font-style:italic;font-size:0.8em;">
<b>Pages</b><br />
<tt> </tt><a class="wikipage" href="Wiki702d.html?page=FindPage">Find</a><br />
<tt> </tt><a class="wikipage" href="Wiki5fc7.html?page=RecentChanges">Recent Changes</a><br />
<tt> </tt><a class="wikipage" href="Wikife97.html?page=UnusedPages">Unused</a><br />
<tt> </tt><a class="wikipage" href="Wiki5130.html?page=UndefinedPages">Undefined</a><br />
<tt> </tt><a class="wikipage" href="Wiki5f9e.html?page=PageIndex">Index</a>
</div>
<p />
    
  </div>
  
  <div class="leftmenufooter">
    <hr />
<p><b>Referenced by</b><br />
<a class="wikipage" href="Wikia360.html?page=Concepts">Concepts</a><br /><a class="wikipage" href="Wiki8680.html?page=Flows">Flows</a><br /><a class="wikipage" href="Wiki6bff.html?page=LogonTest">LogonTest</a><br /><a class="wikipage" href="Wiki2c4e.html?page=LogonTest_2">LogonTest_2</a><br /><a class="wikipage" href="Wiki2664.html?page=TokenStateHolder">TokenStateHolder</a><br />
</p>
    
  </div>

  

  
  
  <div class="wikiversion">JSPWiki v2.8.2
  <span class="rssfeed">
    
  </span>
  </div>  
  
</div>

	<div class="clearbox"></div>
  </div>

  





 
<div id="footer">

  <div class="applicationlogo" > 
    <a href="Wikib2ab.html?page=Main"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  <div class="copyright"></div>

  <div class="wikiversion">
    JSPWiki v2.8.2
  </div>

  <div class="rssfeed">
    
  </div>

</div>

</div>

</body>

<!-- Mirrored from rsf.fluidproject.org/wiki/Wiki.jsp?page=ScopedBeans by HTTrack Website Copier/3.x [XR&CO'2013], Fri, 07 Jun 2013 15:15:57 GMT -->
</html>

